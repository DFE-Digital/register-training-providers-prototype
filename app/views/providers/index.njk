{% extends "layouts/main.njk" %}

{% set primaryNavId = "providers" %}

{% set title = "Providers (" + pagination.totalCount + ")" %}

{% block content %}

{% include "_includes/notification-banner.njk" %}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    {% include "_includes/page-heading.njk" %}

    {{ govukButton({
      text: "Add provider",
      href: actions.new
    }) }}

  </div>
</div>

<div class="app-filter-layout">
  <div class="app-filter-layout__filter">
    {% include "./_filter-panel.njk" %}
  </div>

  <div class="app-filter-layout__content">

    <div class="app-action-bar">
      <div class="app-action-bar__filter"></div>
    </div>

    {% if providers.length %}

      {% include "./_search-panel.njk" %}

      {% for provider in providers %}

        {% set operatingNameHtml %}
          <a href="{{ actions.view }}/{{ provider.id }}" class="govuk-link">
            {{ provider.operatingName }}
          </a>
        {% endset %}

        {{ govukSummaryList({
          card: {
            title: {
              html: operatingNameHtml
            }
          },
          rows: [
            {
              key: {
                text: "Provider type"
              },
              value: {
                text: provider.type | getProviderTypeLabel if provider.type.length else "Not entered",
                classes: "govuk-hint" if not provider.type.length
              }
            },
            {
              key: {
                text: "Operating name"
              },
              value: {
                text: provider.operatingName
              }
            },
            {
              key: {
                text: "Legal name"
              },
              value: {
                text: provider.legalName if provider.legalName.length else "Not entered",
                classes: "govuk-hint" if not provider.legalName.length
              }
            },
            {
              key: {
                text: "UK provider reference number (UKPRN)"
              },
              value: {
                text: provider.ukprn
              }
            },
            {
              key: {
                text: "Unique reference number (URN)"
              },
              value: {
                text: provider.urn if provider.urn.length else "Not entered",
                classes: "govuk-hint" if not provider.urn.length
              }
            } if provider.type == "school",
            {
              key: {
                text: "Provider code"
              },
              value: {
                text: provider.code
              }
            }
          ]
        }) }}

      {% endfor %}

      {# <table class="govuk-table">
        <thead class="govuk-table__head">
          <tr class="govuk-table__row">
            <th scope="col" class="govuk-table__header govuk-!-width-one-third">Operating name</th>
            <th scope="col" class="govuk-table__header govuk-!-width-one-third">Legal name</th>
            <th scope="col" class="govuk-table__header">UK provider reference number (UKPRN)</th>
          </tr>
        </thead>
        <tbody class="govuk-table__body">
          {% for provider in providers %}
            <tr class="govuk-table__row">
              <td class="govuk-table__cell">
                <a class="govuk-link" href="/providers/{{ provider.id }}">
                  {{ provider.operatingName }}
                </a>
              </td>
              <td class="govuk-table__cell {{- ' govuk-hint' if not provider.legalName.length}}">
                {{ provider.legalName if provider.legalName.length else "Not entered" }}
              </td>
              <td class="govuk-table__cell">
                {{ provider.ukprn if provider.ukprn else "Not entered" }}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table> #}

      {% include "_includes/pagination.njk" %}
    {% else %}
      <p class="govuk-body">There are no providers.</p>
    {% endif %}

  </div>
</div>

{% endblock %}
